<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>BungusBot</title>
  <meta name="description" content="BungusBot">
  <meta name="author" content="William,Donnel,Daniel,Kevin,Kevin">

  <style>
  body {background-color: #380060}


  table {
    margin-left: 0;
    top: 20px;
    width: 100%;
    margin-top: 15px;
  }

  td {
    position: relative;
    text-align: center;
    padding: .1vw;
  }

  .twitch-div {
    left: 6px;
    margin: auto;
  }

  #wrapper {
    margin-top: 50px;
  }

  button {
    position:relative;
    top:0%;
    left:0%;
    bottom:58px;
    font-weight: bold;
    font-size: 1.2em
    margin-top:50px;
    margin-bottom:2em;
    width: 100px;
    height: 30px;
    background-color: #380060;
    color: White;
/*  padding: 8px 12px;
    margin: 8px 620px;*/
    border: 2px;
    border-style: solid;
    border-color: White
    border-radius: 2px;
    -o-transition:color .1s ease-out, background .2s ease-in;
    -ms-transition:color .1s ease-out, background .2s ease-in;
    -moz-transition:color .1s ease-out, background .2s ease-in;
    -webkit-transition:color .1s ease-out, background .2s ease-in;
    transition:color .1s ease-out, background .2s ease-in;
  }

  button:hover{
    border-color: #380060;
    color: #380060;
    background-color: White;
  }

  button:focus{
    border-color: #380060;
    color: #380060;
    background-color: #00619b;
  }

</style>

</head>

<body>
  <div style="margin: left"><img src="bungusbotpicture.png" width="180" height="70"> </div>


<table>
  <tr>
    <td>
      <div id="twitch-embed1" class="twitch-div"></div>
      <script src="https://embed.twitch.tv/embed/v1.js"></script>
      <script type="text/javascript">
        new Twitch.Embed("twitch-embed1", {
          width: .24*window.screen.width,
          height: .6*window.screen.height,
          channel: "bobross"
        });
      </script>
    </td><td>
      <div id="twitch-embed2" class="twitch-div"></div>
      <script src="https://embed.twitch.tv/embed/v1.js"></script>
      <script type="text/javascript">
      new Twitch.Embed("twitch-embed2", {
        width: .24*window.screen.width,
        height: .6*window.screen.height,
        channel: "riotgames"
      });
      </script>
    </td><td>
      <div id="twitch-embed3" class="twitch-div"></div>
      <script src="https://embed.twitch.tv/embed/v1.js"></script>
      <script type="text/javascript">
      new Twitch.Embed("twitch-embed3", {
        width: .24*window.screen.width,
        height: .6*window.screen.height,
        channel: "disguisedtoasths"
      });
      </script>
    </td><td>
      <div id="twitch-embed4" class="twitch-div"></div>
      <script src="https://embed.twitch.tv/embed/v1.js"></script>
      <script type="text/javascript">
      new Twitch.Embed("twitch-embed4", {
        width: .24*window.screen.width,
        height: .6*window.screen.height,
        channel: "overwatchleague"
      });
      </script>
    </td>

<table>
  <tr>
    <td align="center"><div id="wrapper"><button type="button" id="streamer1" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer2" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer3" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer4" class="button">clipperino</button></div></td>
  </tr>
  <tr>
    <td>  <div id="p1"></div> <br><font color="white>"><span id="s1"></span></font> </td>
    <td>  <br><font color="white>"><span id="s2"></span></font> </td>
    <td>  <br><font color="white>"><span id="s3"></span></font> </td>
    <td>  <br><font color="white>"><span id="s4"></span></font> </td>
  </tr>

</table>

</body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.0/jquery.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script type="text/javascript">
$("#streamer1").click(function(){
    $.ajax({
        url: '/clip1',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});



$("#streamer2").click(function(){
    $.ajax({
        url: '/clip2',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


$("#streamer3").click(function(){
    $.ajax({
        url: '/clip3',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


$("#streamer4").click(function(){
    $.ajax({
        url: '/clip4',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


console.log("websocket");
var ws = new WebSocket("ws://localhost:8080/websocket");
ws.onopen = function() {
    // ws.send("Hello, world");
};
ws.onmessage = function (evt) {
    obj = JSON.parse(evt.data);

    var sum = obj[0].reduce(function(a, b) { return a + b; });
    var avg = sum / obj[0].length;
    $("#s1").html("average: " + avg + "<br> latest: " + obj[0][obj[0].length - 1])

    sum = obj[1].reduce(function(a, b) { return a + b; });
    avg = sum / obj[1].length;
    $("#s2").html("average: " + avg + "<br> latest: " + obj[1][obj[1].length - 1])

    sum = obj[2].reduce(function(a, b) { return a + b; });
    avg = sum / obj[2].length;
    $("#s3").html("average: " + avg + "<br> latest: " + obj[2][obj[2].length - 1])

    sum = obj[3].reduce(function(a, b) { return a + b; });
    avg = sum / obj[3].length;
    $("#s4").html("average: " + avg + "<br> latest: " + obj[3][obj[3].length - 1])

    var trace = {
      x: Array.from({length: obj[0].length}, (x,i) => i),
      y: obj[0],
      type: 'scatter'
    };
    var data = [trace];
    var layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p1', data, layout);

    trace = {
      x: Array.from({length: obj[1].length}, (x,i) => i),
      y: obj[1],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p2', data, layout);

    trace = {
      x: Array.from({length: obj[2].length}, (x,i) => i),
      y: obj[2],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p3', data, layout);

    trace = {
      x: Array.from({length: obj[3].length}, (x,i) => i),
      y: obj[3],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p4', data, layout);
};

</script>
