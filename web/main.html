<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>BungusBot</title>
  <meta name="description" content="BungusBot">
  <meta name="author" content="William,Donnel,Daniel,Kevin,Kevin">

  <style>
  body {background-color: #380060}


  table {
    top: 50px;
    width: 100%;
    margin-top: 100px;
 }



  #wrapper {
    top: 50px;
  }

  button {
    position:relative;
    top:0%;
    left:0%;
    bottom:58px;
    font-weight: bold;
    font-size: 1.2em
    margin-top:50px;
    margin-bottom:2em;
    width: 100px;
    background-color: #380060;
    color: White;
/*  padding: 8px 12px;
    margin: 8px 620px;*/
    border: 2px;
    border-style: solid;
    border-color: White
    border-radius: 2px;
}

  </style>



</head>

<body>
  <div style="margin: left"><img src="bungusbotpicture.png" width="200" height="100"> </div>

  <!-- <div id="twitch-embed"></div>
<script src="https://embed.twitch.tv/embed/v1.js"></script>
<script type="text/javascript">
  new Twitch.Embed("twitch-embed", {
    width: .24*window.screen.width,
    height: 500,
    channel: "imaqtpie"
  });
</script>

<div id="twitch-embed"></div>
<script src="https://embed.twitch.tv/embed/v1.js"></script>
<script type="text/javascript">
new Twitch.Embed("twitch-embed", {
  width: .24*window.screen.width,
  height: 500,
  channel: "riotgames"
});
</script>

<div id="twitch-embed"></div>
<script src="https://embed.twitch.tv/embed/v1.js"></script>
<script type="text/javascript">
new Twitch.Embed("twitch-embed", {
  width: .24*window.screen.width,
  height: 500,
  channel: "disguisedtoasths"
});
</script>

<div id="twitch-embed"></div>
<script src="https://embed.twitch.tv/embed/v1.js"></script>
<script type="text/javascript">
new Twitch.Embed("twitch-embed", {
  width: .24*window.screen.width,
  height: 500,
  channel: "overwatchleague"
});
</script> -->

<table>
  <tr>
    <td align="center"><div id="wrapper"><button type="button" id="streamer1" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer2" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer3" class="button">clipperino</button></div></td>
    <td align="center"><div id="wrapper"><button type="button" id="streamer4" class="button">clipperino</button></div></td>
</tr>
<tr>
    <td>  <center><div id="p1"></div> <br><font color="#FFFFFF>"><span id="s1"></span></font> </td>
    <td>  <center><div id="p2"></div> <br><font color="#FFFFFF>"><span id="s2"></span></font> </td>
    <td>  <center><div id="p3"></div> <br><font color="#FFFFFF>"><span id="s3"></span></font> </td>
    <td>  <center><div id="p4"></div> <br><font color="#FFFFFF>"><span id="s4"></span></font> </td>
  </tr>
</table>

</body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.0/jquery.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script type="text/javascript">
$("#streamer1").click(function(){
    $.ajax({
        url: '/clip1',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});

$("#streamer2").click(function(){
    $.ajax({
        url: '/clip2',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


$("#streamer3").click(function(){
    $.ajax({
        url: '/clip3',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


$("#streamer4").click(function(){
    $.ajax({
        url: '/clip4',
        data: "nothing",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function(result){
        }
    });
});


console.log("websocket");
var ws = new WebSocket("ws://localhost:8080/websocket");
ws.onopen = function() {
    // ws.send("Hello, world");
};
ws.onmessage = function (evt) {
    obj = JSON.parse(evt.data);

    var sum = obj[0].reduce(function(a, b) { return a + b; });
    var avg = sum / obj[0].length;
    $("#s1").html("average: " + avg + "<br> latest: " + obj[0][obj[0].length - 1])

    sum = obj[1].reduce(function(a, b) { return a + b; });
    avg = sum / obj[1].length;
    $("#s2").html("average: " + avg + "<br> latest: " + obj[1][obj[1].length - 1])

    sum = obj[2].reduce(function(a, b) { return a + b; });
    avg = sum / obj[2].length;
    $("#s3").html("average: " + avg + "<br> latest: " + obj[2][obj[2].length - 1])

    sum = obj[3].reduce(function(a, b) { return a + b; });
    avg = sum / obj[3].length;
    $("#s4").html("average: " + avg + "<br> latest: " + obj[3][obj[3].length - 1])

    var trace = {
      x: Array.from({length: obj[0].length}, (x,i) => i),
      y: obj[0],
      type: 'scatter'
    };
    var data = [trace];
    var layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p1', data, layout);

    trace = {
      x: Array.from({length: obj[1].length}, (x,i) => i),
      y: obj[1],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p2', data, layout);

    trace = {
      x: Array.from({length: obj[2].length}, (x,i) => i),
      y: obj[2],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p3', data, layout);

    trace = {
      x: Array.from({length: obj[3].length}, (x,i) => i),
      y: obj[3],
      type: 'scatter'
    };
    data = [trace];
    layout = {
        width: 400,
        height: 400
    };
    Plotly.newPlot('p4', data, layout);
};

</script>
